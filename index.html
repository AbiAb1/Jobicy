<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remote Job Listings</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        #search-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        #search-input, #category-select, #region-select {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 200px;
        }

        #search-button {
            padding: 10px 20px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            background-color: #007bff;
            color: #fff;
        }

        #search-button:hover {
            background-color: #0056b3;
        }

        #job-listings {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .job {
            display: flex;
            flex-direction: column;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
            background-color: #fff;
        }

        .job h2 {
            margin-bottom: 5px;
        }

        .job img {
            max-width: 100px;
            height: auto;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .job-details {
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <h1>Remote Job Listings</h1>
    <div id="search-container">
        <input type="text" id="search-input" placeholder="Enter keywords...">
        <select id="category-select">
            <option value="">Any Category</option>
            <option value="business">Business Development</option>
            <option value="copywriting">Copywriting & Content</option>
            <option value="supporting">Customer Success</option>
            <option value="data-science">Data Science</option>
            <option value="design-multimedia">Design & Creative</option>
            <option value="admin">DevOps & SysAdmin</option>
            <option value="accounting-finance">Finance & Legal</option>
            <option value="hr">HR & Recruiting</option>
            <option value="marketing">Marketing & Sales</option>
            <option value="management">Product & Operations</option>
            <option value="dev">Programming</option>
            <option value="seller">Sales</option>
            <option value="seo">SEO</option>
            <option value="smm">Social Media Marketing</option>
            <option value="engineering">Software Engineering</option>
            <option value="technical-support">Technical Support</option>
            <option value="web-app-design">Web & App Design</option>
        </select>
        
        <select id="region-select">
            <option value="">From Anywhere</option>
        </select>
        <button id="search-button">Search</button>
    </div>
    <div id="job-listings"></div>

    <script>
       document.addEventListener("DOMContentLoaded", function() {
    const jobListingsContainer = document.getElementById('job-listings');
    const searchInput = document.getElementById('search-input');
    const categorySelect = document.getElementById('category-select');
    const regionSelect = document.getElementById('region-select');
    const searchButton = document.getElementById('search-button');

    // Locations data
    const locations = [
    { "geoID": 446, "geoName": "APAC", "geoSlug": "apac" },
{ "geoID": 449, "geoName": "EMEA", "geoSlug": "emea" },
{ "geoID": 572, "geoName": "LATAM", "geoSlug": "latam" },
{ "geoID": 3804, "geoName": "Argentina", "geoSlug": "argentina" },
{ "geoID": 447, "geoName": "Australia", "geoSlug": "australia" },
{ "geoID": 3827, "geoName": "Austria", "geoSlug": "austria" },
{ "geoID": 3819, "geoName": "Belgium", "geoSlug": "belgium" },
{ "geoID": 1664, "geoName": "Brazil", "geoSlug": "brazil" },
{ "geoID": 3815, "geoName": "Bulgaria", "geoSlug": "bulgaria" },
{ "geoID": 448, "geoName": "Canada", "geoSlug": "canada" },
{ "geoID": 3826, "geoName": "China", "geoSlug": "china" },
{ "geoID": 3820, "geoName": "Costa Rica", "geoSlug": "costa-rica" },
{ "geoID": 3823, "geoName": "Croatia", "geoSlug": "croatia" },
{ "geoID": 3821, "geoName": "Cyprus", "geoSlug": "cyprus" },
{ "geoID": 3824, "geoName": "Czechia", "geoSlug": "czechia" },
{ "geoID": 3833, "geoName": "Denmark", "geoSlug": "denmark" },
{ "geoID": 3831, "geoName": "Estonia", "geoSlug": "estonia" },
{ "geoID": 450, "geoName": "Europe", "geoSlug": "europe" },
{ "geoID": 3810, "geoName": "Finland", "geoSlug": "finland" },
{ "geoID": 1663, "geoName": "France", "geoSlug": "france" },
{ "geoID": 1378, "geoName": "Germany", "geoSlug": "germany" },
{ "geoID": 3808, "geoName": "Greece", "geoSlug": "greece" },
{ "geoID": 3809, "geoName": "Hungary", "geoSlug": "hungary" },
{ "geoID": 3811, "geoName": "Ireland", "geoSlug": "ireland" },
{ "geoID": 3822, "geoName": "Israel", "geoSlug": "israel" },
{ "geoID": 3719, "geoName": "Italy", "geoSlug": "italy" },
{ "geoID": 3828, "geoName": "Japan", "geoSlug": "japan" },
{ "geoID": 3829, "geoName": "Latvia", "geoSlug": "latvia" },
{ "geoID": 3813, "geoName": "Lithuania", "geoSlug": "lithuania" },
{ "geoID": 3718, "geoName": "Mexico", "geoSlug": "mexico" },
{ "geoID": 3690, "geoName": "Netherlands", "geoSlug": "netherlands" },
{ "geoID": 3817, "geoName": "New Zealand", "geoSlug": "new-zealand" },
{ "geoID": 3818, "geoName": "Norway", "geoSlug": "norway" },
{ "geoID": 3835, "geoName": "Philippines", "geoSlug": "philippines" },
{ "geoID": 3803, "geoName": "Poland", "geoSlug": "poland" },
{ "geoID": 3802, "geoName": "Portugal", "geoSlug": "portugal" },
{ "geoID": 3801, "geoName": "Romania", "geoSlug": "romania" },
{ "geoID": 3806, "geoName": "Singapore", "geoSlug": "singapore" },
{ "geoID": 3812, "geoName": "Slovakia", "geoSlug": "slovakia" },
{ "geoID": 3830, "geoName": "Slovenia", "geoSlug": "slovenia" },
{ "geoID": 3825, "geoName": "South Korea", "geoSlug": "south-korea" },
{ "geoID": 671, "geoName": "Spain", "geoSlug": "spain" },
{ "geoID": 3805, "geoName": "Sweden", "geoSlug": "sweden" },
{ "geoID": 3816, "geoName": "Switzerland", "geoSlug": "switzerland" },
{ "geoID": 3807, "geoName": "Thailand", "geoSlug": "thailand" },
{ "geoID": 3799, "geoName": "TÃ¼rkiye", "geoSlug": "turkiye" },
{ "geoID": 444, "geoName": "UK", "geoSlug": "uk" },
{ "geoID": 3800, "geoName": "United Arab Emirates", "geoSlug": "united-arab-emirates" },
{ "geoID": 445, "geoName": "USA", "geoSlug": "usa" },
{ "geoID": 3814, "geoName": "Vietnam", "geoSlug": "vietnam" }

        // Add more locations as needed
    ];

    // Function to populate location select
    function populateRegionSelect() {
        locations.forEach(location => {
            const option = document.createElement('option');
            option.value = location.geoSlug; // Use geoSlug as value
            option.textContent = location.geoName;
            regionSelect.appendChild(option);
        });
    }

    // Call function to populate region select
    populateRegionSelect();

    function fetchJobs(apiUrl, searchTerm) {
    // Clear previous listings
    jobListingsContainer.innerHTML = '';

    var xhr = new XMLHttpRequest();
    xhr.open('GET', apiUrl, true);

    xhr.onload = function () {
        if (xhr.status >= 200 && xhr.status < 300) {
            var data = JSON.parse(xhr.responseText);

            // Check if data.jobs exists and is an array
            if (!data || !Array.isArray(data.jobs)) {
                throw new Error('API response does not contain an array of jobs or data is invalid.');
            }

            if (data.jobs.length === 0) {
                    jobListingsContainer.innerHTML = '<p class="no-jobs">There are no job listings.</p>';
                    return;
                }

            // Process and display job listings
            data.jobs.forEach(job => {
                var jobElement = document.createElement('div');
                jobElement.classList.add('job');

                jobElement.innerHTML = `
                    <h2><a href="${job.url}" target="_blank">${job.jobTitle}</a></h2>
                    <div class="job-details">
                        ${job.companyLogo ? `<img src="${job.companyLogo}" alt="${job.companyName} Logo">` : ''}
                        <p><strong>Company:</strong> ${job.companyName}</p>
                        <p><strong>Industry:</strong> ${job.jobIndustry}</p>
                        <p><strong>Type:</strong> ${job.jobType}</p>
                        <p><strong>Location:</strong> ${job.jobGeo}</p>
                        <p>${job.jobExcerpt}</p>
                    </div>
                `;

                jobListingsContainer.appendChild(jobElement);
            });
        } else {
            console.error('Failed to fetch job listings:', xhr.statusText);
            jobListingsContainer.innerHTML = `<p>Error fetching job listings: ${xhr.statusText}</p>`;
        }
    };

    xhr.onerror = function () {
        console.error('Failed to fetch job listings:', xhr.statusText);
        jobListingsContainer.innerHTML = `<p>Error fetching job listings: ${xhr.statusText}</p>`;
    };

    xhr.send();
}


    function buildApiUrl(searchTerm) {
        let apiUrl = 'https://jobicy.com/api/v2/remote-jobs';
        const params = [];

        const count = 20; // Example: Number of listings to return
        let geo = '';
        let industry = '';
        let tag = '';

        if (categorySelect.value) {
            industry = categorySelect.value;
        }

        if (regionSelect.value) {
            geo = regionSelect.value;
        }

        if (searchTerm !== '') {
            tag = searchTerm;
        }

        params.push(`count=${count}`);
        if (geo) params.push(`geo=${encodeURIComponent(geo)}`);
        if (industry) params.push(`industry=${encodeURIComponent(industry)}`);
        if (tag) params.push(`tag=${encodeURIComponent(tag)}`);

        if (params.length > 0) {
            apiUrl += '?' + params.join('&');
        }

        return apiUrl;
    }

    function handleSearch() {
        const searchTerm = searchInput.value.trim();
        const apiUrl = buildApiUrl(searchTerm);
        fetchJobs(apiUrl, searchTerm);
    }

    function setupEventListeners() {
        searchButton.addEventListener('click', handleSearch);

        searchInput.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                handleSearch();
            }
        });

        categorySelect.addEventListener('change', handleSearch);
        regionSelect.addEventListener('change', handleSearch);
    }

    // Initialize event listeners
    setupEventListeners();

    // Initial fetch on page load for JSON API
    fetchJobs(buildApiUrl(''), '');
});
</script>
</body>
</html>
